{"ast":null,"code":"var _jsxFileName = \"/home/dima/Desktop/learning/dj-blog/caasy-nextjs-blog-template/pages/authors.js\";\nvar __jsx = React.createElement;\nimport React from 'react';\nimport caasy from '@caasy/sdk-js';\nimport Main from '../components/layout/main/Main';\nimport Author from '../components/author/Author';\nimport blogConfig from '../blogConfig';\n\nconst Authors = ({\n  authors\n}) => __jsx(Main, {\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 10,\n    columnNumber: 5\n  }\n}, (authors || []).map(author => __jsx(Author, {\n  key: author.id,\n  author: author,\n  __self: this,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 11,\n    columnNumber: 40\n  }\n})));\n\nexport const getStaticProps = async () => {\n  // Usually, it's sufficient to initialize the Caasy SDK once\n  // in the entire app. However, when running \"next export\",\n  // this configuration is not persisted and therefore it is\n  // necessary to initialize the SDK every time before using it.\n  caasy.init(blogConfig.caasySDKConfig); // Fetch the first page of authors\n\n  const firstPageOfAuthors = await caasy.posts.getAllAuthors(); // Calculate the total pages of authors to fetch\n\n  const totalPages = Math.ceil((firstPageOfAuthors.total || 0) / firstPageOfAuthors.itemsPerPage); // Store all authors\n\n  let allAuthors = [...(firstPageOfAuthors.data || [])]; // Fetch page by page of authors\n\n  for (let i = 2; i <= totalPages; i++) {\n    const authors = await caasy.posts.getAllAuthors(2);\n    allAuthors = [...allAuthors, ...(authors.data || [])];\n  } // Store all authors with their latest posts\n\n\n  const allAuthorsWithPosts = []; // Fetch the latest posts for each author\n\n  for (let author of allAuthors) {\n    const latestPosts = await caasy.posts.getAllByAuthor(author.id);\n    author.posts = latestPosts.data || [];\n    allAuthorsWithPosts.push(author);\n  } // Pass all authors with their latest posts as props to the component\n\n\n  console.log(allAuthorsWithPosts);\n  return {\n    props: {\n      authors: allAuthorsWithPosts\n    }\n  };\n};\nexport default Authors;","map":{"version":3,"sources":["/home/dima/Desktop/learning/dj-blog/caasy-nextjs-blog-template/pages/authors.js"],"names":["React","caasy","Main","Author","blogConfig","Authors","authors","map","author","id","getStaticProps","init","caasySDKConfig","firstPageOfAuthors","posts","getAllAuthors","totalPages","Math","ceil","total","itemsPerPage","allAuthors","data","i","allAuthorsWithPosts","latestPosts","getAllByAuthor","push","console","log","props"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,KAAP,MAAkB,eAAlB;AAEA,OAAOC,IAAP,MAAiB,gCAAjB;AACA,OAAOC,MAAP,MAAmB,6BAAnB;AAEA,OAAOC,UAAP,MAAuB,eAAvB;;AAEA,MAAMC,OAAO,GAAG,CAAC;AAAEC,EAAAA;AAAF,CAAD,KACZ,MAAC,IAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GACK,CAACA,OAAO,IAAI,EAAZ,EAAgBC,GAAhB,CAAoBC,MAAM,IAAI,MAAC,MAAD;AAAQ,EAAA,GAAG,EAAEA,MAAM,CAACC,EAApB;AAAwB,EAAA,MAAM,EAAED,MAAhC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAA9B,CADL,CADJ;;AAMA,OAAO,MAAME,cAAc,GAAG,YAAY;AACtC;AACA;AACA;AACA;AACAT,EAAAA,KAAK,CAACU,IAAN,CAAWP,UAAU,CAACQ,cAAtB,EALsC,CAOtC;;AACA,QAAMC,kBAAkB,GAAG,MAAMZ,KAAK,CAACa,KAAN,CAAYC,aAAZ,EAAjC,CARsC,CAUtC;;AACA,QAAMC,UAAU,GAAGC,IAAI,CAACC,IAAL,CAAU,CAACL,kBAAkB,CAACM,KAAnB,IAA4B,CAA7B,IAAkCN,kBAAkB,CAACO,YAA/D,CAAnB,CAXsC,CAatC;;AACA,MAAIC,UAAU,GAAG,CAAC,IAAGR,kBAAkB,CAACS,IAAnB,IAA2B,EAA9B,CAAD,CAAjB,CAdsC,CAgBtC;;AACA,OAAK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,IAAIP,UAArB,EAAiCO,CAAC,EAAlC,EAAsC;AAClC,UAAMjB,OAAO,GAAG,MAAML,KAAK,CAACa,KAAN,CAAYC,aAAZ,CAA0B,CAA1B,CAAtB;AACAM,IAAAA,UAAU,GAAG,CAAC,GAAGA,UAAJ,EAAgB,IAAGf,OAAO,CAACgB,IAAR,IAAgB,EAAnB,CAAhB,CAAb;AACH,GApBqC,CAsBtC;;;AACA,QAAME,mBAAmB,GAAG,EAA5B,CAvBsC,CAyBtC;;AACA,OAAK,IAAIhB,MAAT,IAAmBa,UAAnB,EAA+B;AAC3B,UAAMI,WAAW,GAAG,MAAMxB,KAAK,CAACa,KAAN,CAAYY,cAAZ,CAA2BlB,MAAM,CAACC,EAAlC,CAA1B;AACAD,IAAAA,MAAM,CAACM,KAAP,GAAeW,WAAW,CAACH,IAAZ,IAAoB,EAAnC;AACAE,IAAAA,mBAAmB,CAACG,IAApB,CAAyBnB,MAAzB;AACH,GA9BqC,CAgCtC;;;AACAoB,EAAAA,OAAO,CAACC,GAAR,CAAYL,mBAAZ;AACA,SAAO;AAAEM,IAAAA,KAAK,EAAE;AAAExB,MAAAA,OAAO,EAAEkB;AAAX;AAAT,GAAP;AACH,CAnCM;AAqCP,eAAenB,OAAf","sourcesContent":["import React from 'react';\nimport caasy from '@caasy/sdk-js';\n\nimport Main from '../components/layout/main/Main';\nimport Author from '../components/author/Author';\n\nimport blogConfig from '../blogConfig';\n\nconst Authors = ({ authors }) => (\n    <Main>\n        {(authors || []).map(author => <Author key={author.id} author={author} />)}\n    </Main>\n);\n\nexport const getStaticProps = async () => {\n    // Usually, it's sufficient to initialize the Caasy SDK once\n    // in the entire app. However, when running \"next export\",\n    // this configuration is not persisted and therefore it is\n    // necessary to initialize the SDK every time before using it.\n    caasy.init(blogConfig.caasySDKConfig);\n\n    // Fetch the first page of authors\n    const firstPageOfAuthors = await caasy.posts.getAllAuthors();\n\n    // Calculate the total pages of authors to fetch\n    const totalPages = Math.ceil((firstPageOfAuthors.total || 0) / firstPageOfAuthors.itemsPerPage);\n\n    // Store all authors\n    let allAuthors = [...firstPageOfAuthors.data || []];\n\n    // Fetch page by page of authors\n    for (let i = 2; i <= totalPages; i++) {\n        const authors = await caasy.posts.getAllAuthors(2);\n        allAuthors = [...allAuthors, ...authors.data || []];\n    }\n\n    // Store all authors with their latest posts\n    const allAuthorsWithPosts = [];\n\n    // Fetch the latest posts for each author\n    for (let author of allAuthors) {\n        const latestPosts = await caasy.posts.getAllByAuthor(author.id);\n        author.posts = latestPosts.data || [];\n        allAuthorsWithPosts.push(author);\n    }\n    \n    // Pass all authors with their latest posts as props to the component\n    console.log(allAuthorsWithPosts)\n    return { props: { authors: allAuthorsWithPosts } };\n};\n\nexport default Authors;\n"]},"metadata":{},"sourceType":"module"}